<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Bits &amp; Signals: Qatar International Cybersecurity Competition :: silly onions — Opinionated articles</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="TL;DR: Al Capwn goes international! We won the second prize hacking hardware with our 15$ (1000 INR) SDR and Logic Analyzer in Doha, Qatar!  In October 2019, Members of Al Capwn flew from New Delhi, India to Doha, Qatar to attend Qatar International Cybersecurity Contest at Hamad Bin Khalifa University. We are thankful of HBKU for sponsoring the complete trip. Specfically, We participated in the Qatar International Hacking Contest, a hardware hacking competition."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019-24-11-hacking-qatar/" />

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-99588570-3', 'auto');
	
	ga('send', 'pageview');
}
</script>


<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/red.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon/red.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Bits &amp; Signals: Qatar International Cybersecurity Competition :: silly onions — Opinionated articles" />
<meta name="twitter:description" content="TL;DR: Al Capwn goes international! We won the second prize hacking hardware with our 15$ (1000 INR) SDR and Logic Analyzer in Doha, Qatar!  In October 2019, Members of Al Capwn flew from New Delhi, India to Doha, Qatar to attend Qatar International Cybersecurity Contest at Hamad Bin Khalifa University. We are thankful of HBKU for sponsoring the complete trip. Specfically, We participated in the Qatar International Hacking Contest, a hardware hacking competition." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Bits &amp; Signals: Qatar International Cybersecurity Competition :: silly onions — Opinionated articles">
<meta property="og:description" content="TL;DR: Al Capwn goes international! We won the second prize hacking hardware with our 15$ (1000 INR) SDR and Logic Analyzer in Doha, Qatar!  In October 2019, Members of Al Capwn flew from New Delhi, India to Doha, Qatar to attend Qatar International Cybersecurity Contest at Hamad Bin Khalifa University. We are thankful of HBKU for sponsoring the complete trip. Specfically, We participated in the Qatar International Hacking Contest, a hardware hacking competition." />
<meta property="og:url" content="/posts/2019-24-11-hacking-qatar/" />
<meta property="og:site_name" content="Bits &amp; Signals: Qatar International Cybersecurity Competition" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:section" content="competition" />
<meta property="article:published_time" content="2019-11-24 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    sillyonions
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/2019-24-11-hacking-qatar/">Bits &amp; Signals: Qatar International Cybersecurity Competition</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2019-11-24
    </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/qicc/">qicc</a>&nbsp;
    
    #<a href="/tags/qatar/">qatar</a>&nbsp;
    
    #<a href="/tags/ctf/">ctf</a>&nbsp;
    
    #<a href="/tags/hardware/">hardware</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    

<ul>
<li><em>TL;DR</em>: Al Capwn goes international! We won the second prize hacking hardware with our 15$ (1000 INR) SDR and Logic Analyzer in Doha, Qatar!</li>
</ul>

<p>In October 2019, Members of Al Capwn flew from New Delhi, India to Doha, Qatar to attend <a href="https://www.hbku.edu.qa/en/qicc">Qatar International Cybersecurity Contest</a> at Hamad Bin Khalifa University. We are thankful of HBKU for sponsoring the complete trip. Specfically, We participated in the Qatar International Hacking Contest, a hardware hacking competition.</p>

<p>This post is going to document the hardware hack, how we conducted security research on the device&rsquo;s presented to us during the competition.</p>

<h2 id="travelog">Travelog</h2>

<p>Being my first international flight, Going for the red wine during the Qatar Airways flight turned out to be a great choice. The first thing we did after landing was get on hand some $$$ to spend, for this I had a <a href="https://www.goniyo.com/">Niyo Global Card</a>. They promise zero fee conversions via their international Visa card, and it worked just as good as a local debit card at both ATMs and POS terminals. Compared to international cards from big banks which charge fees on every transaction, We got zero fees on all our transactions while having control via their decently built application.</p>

<p>Apart from offline payments, The card supports international online payments. Now, you can transact at international ecommerce like AliExpress easily without having a credit card, A problem I often experience as a student with just a debit card. Though, One major problem I faced was that PNB (my savings account) didn&rsquo;t allow NEFT/IMPS transfer to the DCB Bank account registered with the Niyo card.</p>

<p><img src="/img/premier_inn.jpg" alt="Premier Inn, Education City" /></p>

<p>We stayed at the Premier Inn in Education City during the competition. On the first night, we discovered that Zomato operated there and delivered pizza. Though, I wasn&rsquo;t able to make use of my Zomato Gold :P. We visited the Mall Of Qatar (a very big mall, as the name suggests) for a little while which turned out to be a huge nerdgasm. For many my favourite materialistic pleasures, including Sneakers and Video Games all there to play with.</p>

<p><img src="/img/PSClassic.jpg" alt="Playstation Classic" /></p>

<p>The best part was that during the whole week of stay, in this country full of sand, my white sneakers just as white as they were when I left home. This is the future.</p>

<h2 id="qatar-international-hacking-contest">Qatar International Hacking Contest</h2>

<p>A week before the competition we were notified of the 12 devices that we would be given access to at the event, but the specific versions of the devices weren&rsquo;t given to us two days until the competition. We had research done on the devices and strategized to target a few devices which we demmed were attackable. This included a restaurant pager, Ring Video Doorbell camera, a wifi based home security system, and a wifi security camera. The 12 devices had some big shot devices included two Echo Speakers, the latest Bose NCH700 headphones and the Ring wireless alarm kit which worked over Z-Wave. Along with the devices, The organizer&rsquo;s provided us with a HackRF SDR, an iFixit toolkit and an Alfa wireless dongle with monitor mode.</p>

<p><img src="/img/hardware.jpg" alt="Hardware" /></p>

<p>The whole event was divided into 4 sections of 2 hours each over 2 days which was annoying to produce any concrete results, on top of that we were, at first, not allowed to dismantle the devices though we did open them through and packed them back again neatly before the end of the competition.</p>

<p>Our measly toolkit which we brought from home consisted of Multimeter&rsquo;s, cheap Arduinos, a CP2102 based USB FTDI board, a Cypress FX2 based el cheapo <a href="https://robu.in/product/usb-logic-analyze-24m-8ch-mcu-arm-fpga-dsp-debug-tool/">logic analyzer</a> having 8 channels paired with the fantastic open source software <a href="https://sigrok.org/">Sigrok</a> and <a href="https://sigrok.org/wiki/PulseView">PulseView</a>, a variant of the RTL-SDR, and a FOSSASIA <a href="https://pslab.io/">PSLab</a>.</p>

<p><a href="https://labs.portcullis.co.uk/blog/hardware-hacking-how-to-train-a-team/">This</a> also turned out to be very useful.</p>

<h3 id="nadamoo-restaurant-pager-system-http-www-nadamoo-cn-products-pagersystem-squarestyle-2017-09-14-11-html"><a href="http://www.nadamoo.cn/products/PagerSystem/SquareStyle/2017-09-14/11.html">Nadamoo Restaurant Pager System</a></h3>

<p>This device consists of a base station and a receiver, The receiver is given to a customer and when their food gets ready the employees ring up the receiver by sending signals to it from the base station.</p>

<p><img src="/img/nadamoo.jpg" alt="Nadamoo Restaurant Pager System" /></p>

<p>Our initial research on Restaurant Pagers revealed various articles and blog posts on the internet by amazing hackers. <a href="https://hackaday.com/2019/07/30/teardown-catel-ctp300-restaurant-pager/">This</a>, <a href="http://www.windytan.com/2013/09/the-burger-pager.html">this</a>, and <a href="https://www.rtl-sdr.com/using-a-hackrf-to-reverse-engineer-and-control-restaurant-pagers/">this</a> turned out be to very useful for the event. After setting up the device and using the pagers with the base station for a brief, instead of listening to the frequency written at the back of the base station (433.92MHz) I opened up the base station and deduced/guessed from the circuit board and the components that a shift register was used to serialize the data protocol generated from an IC and sent over to the RF component. I hooked my logic analyzer to the pins connecting the number board of the base station to the RF board. Using PulseView, we analyzed the signal transmitted after sending a command to one of the receivers. On one of the lines, We found a digital signal and started reverse engineering the signal.</p>

<p><img src="/img/logic.jfif" alt="Nadamoo Logic Analyzer" /></p>

<p>The complete generated signal consisted of long bursts repeated continuously for a second. Inspecting one of the bursts revealed that they contained the same repeating pattern. This pattern was the protocol which identified the receiver for which the signal was meant.</p>

<p><img src="/img/reverse-nadamoo.png" alt="Reverse Engineered Nadamoo" /></p>

<ul>
<li><p>The signal is an On-Off Keyed digital signal with a structure consisting of 28 bits.</p></li>

<li><p>Preamble (17 bits)</p>

<ul>
<li>10101011110110001</li>
<li>This also contained the identifier of the base station linked with the receiver.</li>
</ul></li>

<li><p>Sync (2 bits)</p>

<ul>
<li>00
<br /></li>
</ul></li>

<li><p>Pager Identifier (8 bits)</p>

<ul>
<li>The pagers are identified by the bitstring in these 8 bits.  The bits are represented in Little Endian.
<br /></li>
</ul></li>

<li><p>Terminator (1 bit)</p>

<ul>
<li>Last bit terminates the message with a 0 bit.</li>
</ul></li>
</ul>

<p><strong><p align='center'>10101011110110001 00 11000000 0</p></strong><p align='center'>For pager numbered 3.</p></p>

<p><img src="/img/nadamoo-table.png" alt="Reverse Engineered Nadamoo" />
<em><p align='center'>Pager ID&rsquo;s: 3, 4, and 5</p></em></p>

<p>We confirmed the reverse engineered protocol by tuning the HackRF to 433.92 MHz and listened to the signals using <a href="https://github.com/jopohl/urh">Universal Radio Hacker</a> which worked like a charm on Windows!</p>

<p><img src="/img/URHpager.png" alt="URH and Pager" /></p>

<p>The demodoulated PCM signal in URH correctly represents the reverse engineering protocol.</p>

<h3 id="todo-fortress-security-system">TODO: Fortress Security System</h3>

<h2 id="conclusion">Conclusion</h2>

<p>We reported all our findings from the Nadamoo Restaurant Pager, Ring Video Doorbell, Lefun Wireless Camera, Letscom Activity Tracker and the Fortress Security to the organizers. Turns out we fared well compared to the competitors and were awarded the second prize at the competition!</p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="/posts/2019-11-11-understanding-x86-virtualization/">
          <span class="button__text">Understanding x86 Virtualization</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "arush15june-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
